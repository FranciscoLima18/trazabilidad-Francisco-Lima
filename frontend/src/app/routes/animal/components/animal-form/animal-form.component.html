<ion-card>
  <ion-card-header>
    <ion-card-title>
      {{ isEditMode ? "Editar Animal" : "Crear Nuevo Animal" }}
    </ion-card-title>
  </ion-card-header>

  <ion-card-content>
    <form [formGroup]="animalForm" (ngSubmit)="onSubmit()">
      <ion-grid>
        <!-- Basic Information -->
        <ion-row>
          <ion-col size="12">
            <ion-item [class.ion-invalid]="isFieldInvalid('breed')">
              <ion-label position="stacked">Raza *</ion-label>
              <ion-select
                formControlName="breed"
                placeholder="Selecciona una raza"
              >
                @for (breed of breeds; track breed) {
                <ion-select-option [value]="breed">{{
                  breed
                }}</ion-select-option>
                }
              </ion-select>
            </ion-item>
            @if (isFieldInvalid('breed')) {
            <div class="error-message">{{ getFieldError("breed") }}</div>
            }
          </ion-col>
        </ion-row>

        <ion-row>
          <ion-col size="12" size-md="6">
            <ion-item [class.ion-invalid]="isFieldInvalid('birth_date')">
              <ion-label position="stacked">Fecha de Nacimiento *</ion-label>
              <ion-input
                type="date"
                formControlName="birth_date"
                placeholder="Selecciona la fecha"
              >
              </ion-input>
            </ion-item>
            @if (isFieldInvalid('birth_date')) {
            <div class="error-message">{{ getFieldError("birth_date") }}</div>
            }
          </ion-col>

          <ion-col size="12" size-md="6">
            <ion-item [class.ion-invalid]="isFieldInvalid('status')">
              <ion-label position="stacked">Estado *</ion-label>
              <ion-select
                formControlName="status"
                placeholder="Selecciona el estado"
              >
                @for (status of statuses; track status) {
                <ion-select-option [value]="status">{{
                  status
                }}</ion-select-option>
                }
              </ion-select>
            </ion-item>
            @if (isFieldInvalid('status')) {
            <div class="error-message">{{ getFieldError("status") }}</div>
            }
          </ion-col>
        </ion-row>

        <!-- Owner and Land Information -->
        <ion-row>
          <ion-col size="12" size-md="6">
            <ion-item [class.ion-invalid]="isFieldInvalid('owner_id')">
              <ion-label position="stacked">ID Propietario *</ion-label>
              <ion-input
                formControlName="owner_id"
                placeholder="Ingresa el ID del propietario"
              >
              </ion-input>
            </ion-item>
            @if (isFieldInvalid('owner_id')) {
            <div class="error-message">{{ getFieldError("owner_id") }}</div>
            }
          </ion-col>

          <ion-col size="12" size-md="6">
            <ion-item [class.ion-invalid]="isFieldInvalid('land_id')">
              <ion-label position="stacked">ID Predio *</ion-label>
              <ion-input
                formControlName="land_id"
                placeholder="Ingresa el ID del predio"
              >
              </ion-input>
            </ion-item>
            @if (isFieldInvalid('land_id')) {
            <div class="error-message">{{ getFieldError("land_id") }}</div>
            }
          </ion-col>
        </ion-row>

        <!-- Form Actions -->
        <ion-row>
          <ion-col size="12">
            <div class="form-actions">
              <ion-button
                expand="block"
                type="submit"
                [disabled]="loading() || animalForm.invalid"
                color="primary"
              >
                @if (loading()) { Guardando... } @else {
                {{ isEditMode ? "Actualizar Animal" : "Crear Animal" }}
                }
              </ion-button>

              <ion-button
                expand="block"
                fill="outline"
                type="button"
                (click)="onCancel()"
                [disabled]="loading()"
              >
                Cancelar
              </ion-button>
            </div>
          </ion-col>
        </ion-row>
      </ion-grid>
    </form>
  </ion-card-content>
</ion-card>
